<mat-action-list>

  <ng-container *ngFor="let user of place.users.getByStatus(true) | entityList">

    <button mat-list-item [matMenuTriggerFor]="userMenu">
      {{user.name}}
    </button>

    <mat-menu #userMenu="matMenu">

      <user-menu-stat [label]="'Added instances: '" [number]="user.stats.instancesAdded"></user-menu-stat>
      <user-menu-stat [label]="'Opened instances: '" [number]="user.stats.instancesOpened"></user-menu-stat>
      <user-menu-stat [label]="'Deleted instances: '" [number]="user.stats.instancesDeleted"></user-menu-stat>

      <button mat-menu-item [matMenuTriggerFor]="userOptions" *ngIf="canTakeAnyActions(user)">
        Manage user
      </button>

      <mat-menu #userOptions="matMenu">

        <button mat-menu-item *ngIf="canRemoveUser(user)" (click)="removeUser(user)">
          Remove
        </button>

        <button mat-menu-item *ngIf="canPromoteUser(user)" (click)="promoteUser(user)">
          Promote
        </button>

      </mat-menu>

    </mat-menu>

  </ng-container>

</mat-action-list>


<mat-form-field style="width: 100%; padding: 0 0.5em">

  <input matInput placeholder="New username." #newUserName [matAutocomplete]="usersAutocomplete"
         (keyup)="form = null" (keyup.ENTER)="searchByName($event.target.value)"/>

  <button mat-icon-button matSuffix [disabled]="form == null" (click)="addUser(); newUserName.target.value = null">
    <mat-icon>add</mat-icon>
  </button>

  <mat-autocomplete #usersAutocomplete="matAutocomplete">
    <mat-option *ngFor="let user of usersList | entityList" [value]="user.name" (click)="form = user;">
      {{user.name}}
    </mat-option>
  </mat-autocomplete>

</mat-form-field>
